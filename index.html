<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <title>–ù–∞—Å—Ç—Ä–æ–∏ÃÜ—â–∏–∫ —Å–º–µ—Ç | –ù–∞—Ç—è–∂–Ω—ã–µ –ø–æ—Ç–æ–ª–∫–∏</title>
    <meta name="description" content="–°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–º–µ—Ç–∞–º–∏ –Ω–∞ –Ω–∞—Ç—è–∂–Ω—ã–µ –ø–æ—Ç–æ–ª–∫–∏">
    
    <!-- PWA –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icons/icon-192.png">
    <meta name="theme-color" content="#4f46e5">
    <meta name="apple-mobile-web-app-title" content="–°–º–µ—Ç—ã">
    
    <!-- –°—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="style.css">
    
    <!-- –ò–∫–æ–Ω–∫–∏ -->
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    
    <!-- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫—Ä–∞–Ω -->
    <div id="splash-screen" class="splash-screen">
        <div class="splash-content">
            <div class="logo">üè†</div>
            <h1>–ù–∞—Å—Ç—Ä–æ–∏ÃÜ—â–∏–∫ —Å–º–µ—Ç</h1>
            <p>–ù–∞—Ç—è–∂–Ω—ã–µ –ø–æ—Ç–æ–ª–∫–∏</p>
            <div class="loading">
                <div class="spinner"></div>
                <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div id="app" class="app-container" style="display: none;">
        <!-- –®–∞–ø–∫–∞ -->
        <header class="app-header">
            <div class="header-left">
                <button id="menu-toggle" class="icon-button">‚ò∞</button>
                <h1 id="current-page">–°–º–µ—Ç—ã</h1>
            </div>
            <div class="header-right">
                <button id="theme-toggle" class="icon-button">üåô</button>
                <button id="sync-button" class="icon-button" title="–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å">üîÑ</button>
            </div>
        </header>

        <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <div class="company-info">
                    <h2>PotolokForLife</h2>
                    <p>–ù–∞—Ç—è–∂–Ω—ã–µ –ø–æ—Ç–æ–ª–∫–∏ –Ω–∞ –≤—Å—é –∂–∏–∑–Ω—å</p>
                    <p class="small">8(977)531-10-99</p>
                </div>
                <button id="close-menu" class="icon-button">√ó</button>
            </div>
            
            <div class="menu-section">
                <h3>–û—Å–Ω–æ–≤–Ω–æ–µ</h3>
                <ul class="menu-list">
                    <li><a href="#" class="menu-item active" data-page="estimates">üìã –°–º–µ—Ç—ã</a></li>
                    <li><a href="#" class="menu-item" data-page="create">‚ûï –ù–æ–≤–∞—è —Å–º–µ—Ç–∞</a></li>
                    <li><a href="#" class="menu-item" data-page="templates">üìÅ –®–∞–±–ª–æ–Ω—ã</a></li>
                    <li><a href="#" class="menu-item" data-page="clients">üë• –ö–ª–∏–µ–Ω—Ç—ã</a></li>
                </ul>
            </div>
            
            <div class="menu-section">
                <h3>–ë–∞–∑–∞ –ø–æ–∑–∏—Ü–∏–π</h3>
                <ul class="menu-list">
                    <li><a href="#" class="menu-item" data-page="items">üì¶ –ü–æ–∑–∏—Ü–∏–∏</a></li>
                    <li><a href="#" class="menu-item" data-page="categories">üóÇÔ∏è –ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a></li>
                </ul>
            </div>
            
            <div class="menu-section">
                <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                <ul class="menu-list">
                    <li><a href="#" class="menu-item" data-page="company">üè¢ –ö–æ–º–ø–∞–Ω–∏—è</a></li>
                    <li><a href="#" class="menu-item" data-page="settings">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a></li>
                </ul>
            </div>
            
            <div class="sidebar-footer">
                <div class="storage-info">
                    <div class="storage-bar">
                        <div class="storage-fill" id="storage-fill"></div>
                    </div>
                    <p>–•—Ä–∞–Ω–∏–ª–∏—â–µ: <span id="storage-used">0</span>/<span id="storage-total">5</span> –ú–ë</p>
                </div>
                <button id="install-btn" class="btn-secondary" style="display: none;">üì≤ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                <button id="export-all" class="btn-secondary">üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
            </div>
        </nav>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="main-content">
            <!-- –≠–∫—Ä–∞–Ω —Å–ø–∏—Å–∫–∞ —Å–º–µ—Ç -->
            <div id="estimates-page" class="page active">
                <div class="page-header">
                    <h2>–°–º–µ—Ç—ã</h2>
                    <div class="actions">
                        <button id="new-estimate" class="btn-primary">‚ûï –ù–æ–≤–∞—è —Å–º–µ—Ç–∞</button>
                        <div class="search-box">
                            <input type="text" id="search-estimates" placeholder="–ü–æ–∏—Å–∫ —Å–º–µ—Ç...">
                            <span>üîç</span>
                        </div>
                    </div>
                </div>
                
                <div class="page-actions">
                    <button id="export-json" class="btn-secondary">üì§ –≠–∫—Å–ø–æ—Ä—Ç JSON</button>
                    <label for="import-json" class="btn-secondary">
                        üì• –ò–º–ø–æ—Ä—Ç JSON
                        <input type="file" id="import-json" accept=".json" style="display: none;">
                    </label>
                    <button id="import-excel" class="btn-secondary">üìä –ò–º–ø–æ—Ä—Ç –∏–∑ Excel</button>
                </div>
                
                <div class="filters">
                    <select id="filter-status">
                        <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                        <option value="draft">–ß–µ—Ä–Ω–æ–≤–∏–∫</option>
                        <option value="sent">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</option>
                        <option value="accepted">–ü—Ä–∏–Ω—è—Ç–æ</option>
                        <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</option>
                    </select>
                    <select id="sort-by">
                        <option value="date-desc">–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</option>
                        <option value="date-asc">–°–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ</option>
                        <option value="name">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é</option>
                        <option value="amount">–ü–æ —Å—É–º–º–µ</option>
                    </select>
                </div>
                
                <div id="estimates-list" class="estimates-grid">
                    <!-- –°–º–µ—Ç—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>

            <!-- –≠–∫—Ä–∞–Ω —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–º–µ—Ç—ã -->
            <div id="create-page" class="page">
                <div class="page-header">
                    <h2 id="edit-title">–ù–æ–≤–∞—è —Å–º–µ—Ç–∞</h2>
                    <div class="actions">
                        <button id="save-estimate" class="btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                        <button id="preview-pdf" class="btn-secondary">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä PDF</button>
                        <button id="export-pdf" class="btn-success">üìÑ –°–æ–∑–¥–∞—Ç—å PDF</button>
                    </div>
                </div>
                
                <div class="estimate-form">
                    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                    <div class="form-section">
                        <h3>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Å–º–µ—Ç—ã *</label>
                                <input type="text" id="estimate-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–≤–∞—Ä—Ç–∏—Ä–∞ –≤ –•–∏–º–∫–∞—Ö">
                            </div>
                            <div class="form-group">
                                <label>–°—Ç–∞—Ç—É—Å</label>
                                <select id="estimate-status">
                                    <option value="draft">–ß–µ—Ä–Ω–æ–≤–∏–∫</option>
                                    <option value="sent">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–ª–∏–µ–Ω—Ç—É</option>
                                    <option value="accepted">–ü—Ä–∏–Ω—è—Ç–æ</option>
                                    <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>–û–±—ä–µ–∫—Ç *</label>
                                <input type="text" id="estimate-object" placeholder="–ö–≤–∞—Ä—Ç–∏—Ä–∞ / –û—Ñ–∏—Å / –î–æ–º">
                            </div>
                            <div class="form-group">
                                <label>–ê–¥—Ä–µ—Å *</label>
                                <input type="text" id="estimate-address" placeholder="–ü–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å">
                            </div>
                            <div class="form-group">
                                <label>–ö–æ–ª-–≤–æ –ø–æ–º–µ—â–µ–Ω–∏–π</label>
                                <input type="number" id="estimate-rooms" min="1" value="1">
                            </div>
                            <div class="form-group">
                                <label>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</label>
                                <input type="date" id="estimate-date" value="">
                            </div>
                        </div>
                    </div>
                    
                    <!-- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–º–µ—â–µ–Ω–∏—è -->
                    <div class="form-section">
                        <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–º–µ—â–µ–Ω–∏—è</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>–ü–ª–æ—â–∞–¥—å (S), –º¬≤</label>
                                <input type="number" id="area-s" step="0.01" min="0" value="0">
                            </div>
                            <div class="form-group">
                                <label>–ü–µ—Ä–∏–º–µ—Ç—Ä (P), –º</label>
                                <input type="number" id="perimeter-p" step="0.01" min="0" value="0">
                            </div>
                            <div class="form-group">
                                <label>–í—ã—Å–æ—Ç–∞ (h), –º</label>
                                <input type="number" id="height-h" step="0.01" min="0" value="0">
                            </div>
                        </div>
                    </div>
                    
                    <!-- –ü–æ–∑–∏—Ü–∏–∏ —Å–º–µ—Ç—ã -->
                    <div class="form-section">
                        <div class="section-header">
                            <h3>–ü–æ–∑–∏—Ü–∏–∏ —Å–º–µ—Ç—ã</h3>
                            <button type="button" id="add-item" class="btn-secondary">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é</button>
                            <button type="button" id="add-from-template" class="btn-secondary">üìÅ –ò–∑ —à–∞–±–ª–æ–Ω–∞</button>
                        </div>
                        
                        <div class="items-table-container">
                            <table class="items-table">
                                <thead>
                                    <tr>
                                        <th width="30">#</th>
                                        <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th>
                                        <th width="80">–ï–¥.–∏–∑–º.</th>
                                        <th width="100">–ö–æ–ª-–≤–æ</th>
                                        <th width="120">–¶–µ–Ω–∞, —Ä—É–±.</th>
                                        <th width="120">–°—É–º–º–∞, —Ä—É–±.</th>
                                        <th width="60">–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody id="items-tbody">
                                    <!-- –°—Ç—Ä–æ–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td colspan="4"></td>
                                        <td><strong>–ò—Ç–æ–≥–æ:</strong></td>
                                        <td><strong id="total-amount">0.00</strong></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td colspan="4"></td>
                                        <td>–°–∫–∏–¥–∫–∞:</td>
                                        <td>
                                            <input type="number" id="discount" min="0" max="100" step="1" value="0" style="width: 60px;"> %
                                            <span id="discount-amount">0.00</span>
                                        </td>
                                        <td></td>
                                    </tr>
                                    <tr class="total-row">
                                        <td colspan="4"></td>
                                        <td><strong>–ö –æ–ø–ª–∞—Ç–µ:</strong></td>
                                        <td><strong id="final-amount">0.00</strong></td>
                                        <td></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                    
                    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                    <div class="form-section">
                        <h3>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        <div class="form-group">
                            <label>–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</label>
                            <textarea id="estimate-notes" rows="3" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>–£—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã</label>
                            <div class="payment-terms">
                                <label><input type="checkbox" id="payment-50-50" checked> 50% –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞</label>
                                <label><input type="checkbox" id="payment-100-material"> 100% –∑–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</label>
                            </div>
                            <textarea id="payment-details" rows="2">1. –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ 50% –Ω–µ –ø–æ–∑–¥–Ω–µ–µ 3-—Ö –¥–Ω–µ–π –¥–æ –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–π –¥–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–æ–Ω—Ç–∞–∂–∞ 1-–≥–æ —ç—Ç–∞–ø–∞.
2. –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç 50% –≤ –¥–µ–Ω—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö —Ä–∞–±–æ—Ç.
–û–ø–ª–∞—Ç–∞ –∑–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è 100% –¥–æ –Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç.</textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –≠–∫—Ä–∞–Ω —à–∞–±–ª–æ–Ω–æ–≤ -->
            <div id="templates-page" class="page">
                <div class="page-header">
                    <h2>–®–∞–±–ª–æ–Ω—ã</h2>
                    <div class="actions">
                        <button id="new-template" class="btn-primary">‚ûï –ù–æ–≤—ã–π —à–∞–±–ª–æ–Ω</button>
                    </div>
                </div>
                
                <div class="templates-list">
                    <!-- –®–∞–±–ª–æ–Ω—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>

            <!-- –≠–∫—Ä–∞–Ω —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏—è–º–∏ -->
            <div id="items-page" class="page">
                <div class="page-header">
                    <h2>–ë–∞–∑–∞ –ø–æ–∑–∏—Ü–∏–π</h2>
                    <div class="actions">
                        <button id="new-item" class="btn-primary">‚ûï –ù–æ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è</button>
                        <button id="export-items" class="btn-secondary">üì§ –≠–∫—Å–ø–æ—Ä—Ç –ø–æ–∑–∏—Ü–∏–π</button>
                        <label for="import-items" class="btn-secondary">
                            üì• –ò–º–ø–æ—Ä—Ç –ø–æ–∑–∏—Ü–∏–π
                            <input type="file" id="import-items" accept=".json" style="display: none;">
                        </label>
                        <button id="reset-items" class="btn-danger">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –∫ –∑–∞–≤–æ–¥—Å–∫–∏–º</button>
                    </div>
                </div>
                
                <div class="items-manager">
                    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏ -->
                </div>
            </div>

            <!-- –î—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ -->
        </main>

        <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
        <div id="modal-overlay" class="modal-overlay"></div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏ -->
        <div id="add-item-modal" class="modal">
            <div class="modal-header">
                <h3>–î–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é</h3>
                <button class="modal-close">√ó</button>
            </div>
            <div class="modal-body">
                <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏ -->
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ PDF -->
        <div id="pdf-preview-modal" class="modal modal-large">
            <div class="modal-header">
                <h3>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –ö–ü</h3>
                <button class="modal-close">√ó</button>
            </div>
            <div class="modal-body">
                <div id="pdf-preview-content">
                    <!-- PDF preview will be rendered here -->
                </div>
            </div>
        </div>

        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
        <div id="notifications"></div>
    </div>

    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="app.js" type="module"></script>
    <script src="pdf-generator.js" type="module"></script>
</body>
</html>
